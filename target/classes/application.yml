---
micronaut:
  application:
    name: registrationService
  metrics:
    enabled: true
    export:
      datadog:
        enabled: false
  environments:
    development:
      micronaut:
        metrics:
          export:
            datadog:
              enabled: false
      environments: true
      config:
        registration:
          useLdap: true
    production:
      config:
        registration:
          useLdap: true
  executors:
    scheduled:
      type: scheduled
      corePoolSize: 16
  rateLimits:
    checkVerificationCode:
      delays: 60s
    leakyBucket:
      sessionCreation:
        name: registration
        maxCapacity: 100
        permitRegenerationPeriod: 10s
        minDelay: 25s
    sendSmsVerificationCode:
      delays: 10s
    sendVoiceVerificationCode:
      delayAfterFirstSms: 120s
      delays: 60s
  config:
    registration:
      # Directory service type configuration
      directory:
        type: ENTRA_ID  # Can be LDAP or ENTRA_ID

      # LDAP Configuration
      ldap:
        # LDAP server connection settings
        url: ldap://localhost:389
        baseDn: dc=valuelabs,dc=com
        useSsl: false
        trustStore: /Users/jgnoonan/registration-service/src/main/resources/certs/truststore.jks
        trustStorePassword: changeit
        trustStoreType: JKS
        hostnameVerification: true
        connectionTimeout: 30000
        readTimeout: 30000
        minPoolSize: 3
        maxPoolSize: 10
        poolTimeout: 300000
        maxRetries: 3
        userFilter: (uid={0})
        bindDn: cn=admin,dc=valuelabs,dc=com
        bindPassword: Rat3onal
        phoneNumberAttribute: mobile

      # Microsoft Entra ID Configuration (formerly Azure AD)
      entra-id:
        enabled: true
        tenant-id: "2f8b8c95-8509-4822-a393-dc8f12d2c829"
        client-id: "a7106d81-6dc4-42bf-bcf9-21666789ea05"
        # Use either client-secret or certificate-path, not both
        client-secret: ${ENTRA_CLIENT_SECRET}
        # certificate-path: "${ENTRA_CERTIFICATE_PATH}"  # Alternative to client secret

messagebird:
  enabled: false

bigtable:
  enabled: false

gcp:
  enabled: false

twilio:
  enabled: false

infobip:
  enabled: false

selection:
  sms:
    transport: NONE
    fallbackSenders: ["last-digits-of-phone-number"]
  voice:
    transport: VOICE
    fallbackSenders: ["last-digits-of-phone-number"]
    defaultWeights:
      last-digits-of-phone-number: 100

grpc:
  server:
    endpoint: localhost
    port: 50051
