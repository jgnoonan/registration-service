micronaut:
  application:
    name: registrationService-test
  server:
    port: -1  # Disable HTTP server
  grpc:
    server:
      port: 50051
  environments:
    development:
      environments: true
  config:
    registration:
      useLdap: false
      ldap:
        url: ldap://localhost:11389  # Use test port
        baseDn: dc=test,dc=com
        bindDn: cn=admin,dc=test,dc=com
        bindPassword: test
        userFilter: (|(uid={0})(mail={0}))
        phoneNumberAttribute: mobile
        useSsl: false
        minPoolSize: 1
        maxPoolSize: 3
        poolTimeout: 1000
        testUser: test@test.com
        testUserPassword: test
  metrics:
    enabled: true
    export:
      datadog:
        enabled: false
      prometheus:
        enabled: true
        step: PT1M
        descriptions: true

twilio:
  verify:
    service-sid: test-service-sid
    service-friendly-name: test-service
    android-app-hash: test-hash
    custom-template-sid: test-template
    custom-template-supported-languages: []
    supported-languages: []

# Metrics configuration
micronaut:
  metrics:
    enabled: true
    export:
      prometheus:
        enabled: true
        step: PT1M
        descriptions: true

# Test-specific configurations
test:
  mock:
    enabled: true
  useLdap: false
  testUser: raja@valuelabs.com
  testUserPassword: Rat3onal
  verification:
    use-phone-number-suffix: true

ldap:
  enabled: false
  test-mode: true
  url: "ldap://localhost:389"
  base-dn: "dc=test,dc=local"
  use-ssl: false

redis:
  uri: "redis://localhost:6379"
  test-mode: true

registration:
  session:
    duration: PT10M
    attempts: 5
  rate-limits:
    session-creation:
      bucket-size: 2
      leak-rate-per-minute: 1
    send-sms-verification-code:
      bucket-size: 2
      leak-rate-per-minute: 1
    send-voice-verification-code:
      bucket-size: 2
      leak-rate-per-minute: 1
    check-verification-code:
      bucket-size: 2
      leak-rate-per-minute: 1

# Configure rate limiters for testing
rateLimits:
  leakyBucket:
    sessionCreation:
      name: sessionCreation
      maxCapacity: 100
      permitRegenerationPeriod: 1s
      minDelay: 0s
    sendSmsVerificationCode:
      name: sendSmsVerificationCode
      maxCapacity: 100
      permitRegenerationPeriod: 1s
      minDelay: 0s
    sendVoiceVerificationCode:
      name: sendVoiceVerificationCode
      maxCapacity: 100
      permitRegenerationPeriod: 1s
      minDelay: 0s
    checkVerificationCode:
      name: checkVerificationCode
      maxCapacity: 100
      permitRegenerationPeriod: 1s
      minDelay: 0s

rate-limits:
  send-sms-verification-code:
    delays: 1s,2s,5s,10s
  send-voice-verification-code:
    delays: 1s,2s,5s,10s
  check-verification-code:
    delays: 1s,2s,5s,10s

# Sender selection configuration
selection:
  sms:
    fallback-senders: []
    default-weights: {}
    region-weights: {}
    region-overrides: {}
  voice:
    fallback-senders: []
    default-weights: {}
    region-weights: {}
    region-overrides: {}
